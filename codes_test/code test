import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Laad de dataset
atp_data = pd.read_csv('datasets/ATP - Sheet1.csv')

# Verwijder rijen met ontbrekende waarden in relevante kolommen
atp_data_clean = atp_data.dropna(subset=['surface', 'winner_name', 'loser_name'])

# Bereken het aantal overwinningen per speler per ondergrond
surface_wins = atp_data_clean.groupby(['surface', 'winner_name']).size().reset_index(name='win_count')

# Bereken het aantal gespeelde wedstrijden per speler per ondergrond
surface_matches = (atp_data_clean.groupby(['surface', 'winner_name']).size() + 
                   atp_data_clean.groupby(['surface', 'loser_name']).size()).reset_index(name='match_count')

# Voeg de dataframes samen op ondergrond en winnaar_naam
surface_stats = pd.merge(surface_wins, surface_matches, how='left', left_on=['surface', 'winner_name'], right_on=['surface', 'winner_name'])

# Bereken het winpercentage
surface_stats['win_percentage'] = (surface_stats['win_count'] / surface_stats['match_count']) * 100

# Plot het winpercentage voor elke ondergrond
plt.figure(figsize=(14, 8))
sns.boxplot(x='surface', y='win_percentage', data=surface_stats, palette='viridis')
plt.title('Win Percentage on Each Surface')
plt.xlabel('Surface Type')
plt.ylabel('Win Percentage')
plt.show()
